require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages_userActivity/articleDes/articleDes","common/main"],{"0b35":function(e,t,n){"use strict";n.r(t);var o=n("2316"),r=n.n(o);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=r.a},"0f84":function(e,t,n){"use strict";var o=n("b58a"),r=n.n(o);r.a},2316:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n("095e"),r={data:function(){return{globalData:{ws:{}}}},onLaunch:function(){var e=this;o.init(),o.on("onOpen",(function(){e.globalData.ws=o.ws}))},onLoad:function(){console.log("App onLoad")},onShow:function(){console.log("App Show")},onHide:function(){console.log("App Hide")},onUnload:function(){console.log("App Unload")},methods:{updateWs:function(){var e=this;console.log("updateWs"),o.init(),o.on("onOpen",(function(){e.globalData.ws=o.ws}))}}};t.default=r},"2a47":function(e,t,n){},"2ba8":function(e,t,n){"use strict";var o=n("2a47"),r=n.n(o);r.a},4317:function(e,t,n){"use strict";(function(e){n("6090");var t=u(n("9fbb")),o=u(n("66fd")),r=u(n("cc95")),i=u(n("7143"));function u(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}wx.__webpack_require_UNI_MP_PLUGIN__=n,o.default.use(r.default),o.default.prototype.$store=i.default,o.default.config.productionTip=!1,t.default.mpType="app";var l=new o.default(c({store:i.default},t.default));e(l).$mount()}).call(this,n("543d")["createApp"])},"58b3":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n("a34a")),r=n("3c6a"),i=n("18ca"),u=n("26cb");function a(e){return e&&e.__esModule?e:{default:e}}function c(e){return f(e)||d(e)||l(e)||s()}function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e,t){if(e){if("string"===typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}function d(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function f(e){if(Array.isArray(e))return p(e)}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function b(e,t,n,o,r,i,u){try{var a=e[i](u),c=a.value}catch(s){return void n(s)}a.done?t(c):Promise.resolve(c).then(o,r)}function h(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var i=e.apply(t,n);function u(e){b(i,o,r,u,a,"next",e)}function a(e){b(i,o,r,u,a,"throw",e)}u(void 0)}))}}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w=getApp(),O={computed:v({},(0,u.mapState)(["uid","house"])),data:function(){return{ws:"",id:"",aImgList:[],avideo:"",limit:20,page:1,lastPage:"",myList:[],isloading:!1,oneRecordList:[],noMedia:!1,showInput:!1,textMsg:"",twoRecordList:[],showMoreRecord:!1,artObj:{},popMoney:!1,sendMoney:"",sendFlower:"",sendPoo:"",showRemoveArt:!1,pid:"",toUid:"",receiveUid:""}},onLoad:function(e){this.id=e.i,this.getDetail(),this.oneRecordList=[],this.getCommentList(),this.ws=w.globalData.ws,this.ws.onMessage((function(e){console.log("接收消息ing"),console.log(e)}))},onShareAppMessage:function(){return{title:"X空间，一起发现有趣的人~",path:"/pages_userActivity/articleDes/articleDes?i="+this.id,imgUrl:"/static/time.png"}},onReachBottom:function(){this.page>=this.lastPage||this.isloading||(this.page+=1,this.getCommentList())},methods:{getDetail:function(){var t=this;return h(o.default.mark((function n(){var i,u,a;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,r.detail)({id:t.id});case 2:if(i=n.sent,console.log("获取详情"),console.log(i),0===i.code){n.next=8;break}return e.showToast({title:"获取动态详情失败",icon:"none",duration:2e3}),n.abrupt("return");case 8:if(t.artObj=i.result,t.toUid=i.result.uid,t.receiveUid=i.result.uid,0!==t.artObj.media.length){n.next=13;break}return n.abrupt("return");case 13:u=t.artObj.media[0],a=/(\.gif|\.jpeg|\.png|\.jpg|\.bmp)/,a.test(u)?t.aImgList=t.artObj.media:t.avideo=t.artObj.media[0];case 16:case"end":return n.stop()}}),n)})))()},changeCollection:function(t){var n=this;return h(o.default.mark((function i(){var u,a,c;return o.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(n.house){o.next=3;break}return e.showToast({title:"请先成为空间主人",icon:"none",duration:2e3}),o.abrupt("return");case 3:if(1!==t){o.next=16;break}return o.next=6,(0,r.addCollection)({id:n.id});case 6:if(o.sent,n.$set(n.artObj,"isCollection",!0),u=n.artObj.collectionCount+1,n.$set(n.artObj,"collectionCount",u),n.uid!==n.receiveUid){o.next=12;break}return o.abrupt("return");case 12:a={fromUid:n.uid,toUid:n.receiveUid,text:"点赞了您的动态",type:"collection"},n.ws.send({data:JSON.stringify(a),success:function(){console.log("点赞消息发送成功")}}),o.next=23;break;case 16:if(2!==t){o.next=23;break}return o.next=19,(0,r.cancelCollection)({id:n.id});case 19:o.sent,n.$set(n.artObj,"isCollection",!1),c=n.artObj.collectionCount-1,n.$set(n.artObj,"collectionCount",c);case 23:case"end":return o.stop()}}),i)})))()},getCommentList:function(){var t=this;return h(o.default.mark((function n(){var i;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.isloading=!0,n.next=3,(0,r.getComment)({postId:t.id,page:t.page,limit:t.limit});case 3:if(i=n.sent,console.log("请求用户评论"),console.log(i),0===i.code){n.next=9;break}return e.showToast({title:"获取用户评论失败",icon:"none",duration:2e3}),n.abrupt("return");case 9:t.isloading=!1,t.oneRecordList=[].concat(c(t.oneRecordList),c(i.result.data)),t.lastPage=i.result.last_page;case 12:case"end":return n.stop()}}),n)})))()},openInput:function(e){this.showInput=!0,e?(this.pid=e.id,this.toUid=e.uid):(this.pid=0,this.toUid=this.receiveUid)},openPop:function(){this.house?this.receiveUid!==this.uid?this.popMoney=!0:e.showToast({title:"不可以给自己助力",icon:"none",duration:2e3}):e.showToast({title:"请先成为空间主人",icon:"none",duration:2e3})},sendMoneyOrFlowerOrPoo:function(){var t=this;return h(o.default.mark((function n(){var u,a,c;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.sendMoney||t.sendFlower||t.sendPoo){n.next=3;break}return e.showToast({title:"不可以助力空数量",icon:"none",duration:2e3}),n.abrupt("return");case 3:if(!t.sendMoney){n.next=11;break}return n.next=6,(0,i.giveSilver)({num:t.sendMoney,receiveUid:t.receiveUid,type:1,receivePostid:t.id});case 6:if(u=n.sent,0===u.code){n.next=10;break}return e.showToast({title:"赠送银元失败",icon:"none",duration:2e3}),n.abrupt("return");case 10:t.artObj.silverNum+=1;case 11:if(!t.sendFlower){n.next=19;break}return n.next=14,(0,i.giveFlower)({num:t.sendFlower,receiveUid:t.receiveUid,type:2,receivePostid:t.id});case 14:if(a=n.sent,0===a.code){n.next=18;break}return e.showToast({title:"赠送鲜花失败",icon:"none",duration:2e3}),n.abrupt("return");case 18:t.artObj.flowerNum+=1;case 19:if(!t.sendPoo){n.next=27;break}return n.next=22,(0,r.giveEgg)({num:t.sendPoo,receiveUid:t.receiveUid,type:3,receivePostid:t.id});case 22:if(c=n.sent,0===c.code){n.next=26;break}return e.showToast({title:"赠送粪便失败",icon:"none",duration:2e3}),n.abrupt("return");case 26:t.artObj.eggNum+=1;case 27:t.popMoney=!1;case 28:case"end":return n.stop()}}),n)})))()},openMoreRecord:function(e){this.showInput=!1,e.children&&0!==e.children.length&&(this.showMoreRecord=!0,this.twoRecordList=e.children)},sendText:function(){var t=this;return h(o.default.mark((function n(){var i,u;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.house){n.next=3;break}return e.showToast({title:"请先成为空间主人",icon:"none",duration:2e3}),n.abrupt("return");case 3:if(t.textMsg){n.next=6;break}return e.showToast({title:"不可以发表空评论哦",icon:"none",duration:2e3}),n.abrupt("return");case 6:return n.next=8,(0,r.addComment)({content:t.textMsg,pid:t.pid,postId:t.id,toUid:t.toUid});case 8:if(i=n.sent,0===i.code){n.next=12;break}return e.showToast({title:"评论失败",icon:"none",duration:2e3}),n.abrupt("return");case 12:if(t.textMsg="",t.showInput=!1,e.showToast({title:"评论成功",icon:"none",duration:2e3}),t.oneRecordList=[],t.getCommentList(),t.uid!==t.toUid){n.next=19;break}return n.abrupt("return");case 19:u={fromUid:t.uid,toUid:t.toUid,text:"评论了您的动态",type:"comment"},t.ws.send({data:JSON.stringify(u),success:function(){console.log("评论消息发送成功")}});case 21:case"end":return n.stop()}}),n)})))()},lowerMoreRecord:function(){},confirmRemoveArt:function(){var t=this;return h(o.default.mark((function n(){var i;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return console.log(t.id),n.next=3,(0,r.deletePost)({id:t.id});case 3:if(i=n.sent,console.log(i),0===i.code){n.next=8;break}return e.showToast({title:"删除动态失败",icon:"none",duration:2e3}),n.abrupt("return");case 8:e.showToast({title:"已删除",icon:"none",duration:2e3}),e.navigateBack({});case 10:case"end":return n.stop()}}),n)})))()},toOtherUser:function(){}}};t.default=O}).call(this,n("543d")["default"])},"7ac7":function(e,t,n){"use strict";(function(e){n("6090");o(n("66fd"));var t=o(n("f632"));function o(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=n,e(t.default)}).call(this,n("543d")["createPage"])},"9fbb":function(e,t,n){"use strict";n.r(t);var o=n("0b35");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);n("0f84");var i,u,a,c,s=n("f0c5"),l=Object(s["a"])(o["default"],i,u,!1,null,null,null,!1,a,c);t["default"]=l.exports},b58a:function(e,t,n){},bfbc:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o}));var o={uIcon:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-icon/u-icon")]).then(n.bind(null,"74c9"))},uLoadingIcon:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-loading-icon/u-loading-icon")]).then(n.bind(null,"b6e4"))},uPopup:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-popup/u-popup")]).then(n.bind(null,"356e"))},"u-Input":function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u--input/u--input")]).then(n.bind(null,"246b"))},uModal:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-modal/u-modal")]).then(n.bind(null,"c0b5"))}},r=function(){var e=this,t=e.$createElement;e._self._c;e._isMounted||(e.e0=function(t){e.showRemoveArt=!0},e.e1=function(t){e.showMoreRecord=!1},e.e2=function(t){e.popMoney=!1},e.e3=function(t){e.showRemoveArt=!1})},i=[]},d15e:function(e,t,n){"use strict";n.r(t);var o=n("58b3"),r=n.n(o);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=r.a},f632:function(e,t,n){"use strict";n.r(t);var o=n("bfbc"),r=n("d15e");for(var i in r)"default"!==i&&function(e){n.d(t,e,(function(){return r[e]}))}(i);n("2ba8");var u,a=n("f0c5"),c=Object(a["a"])(r["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],u);t["default"]=c.exports}},[["7ac7","common/runtime","common/vendor","pages_userActivity/common/vendor"]]]);