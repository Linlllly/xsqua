{"version":3,"sources":["webpack:////Users/linglinglin/Desktop/uniapp/xsqua/components/cropping/cropping.vue?5e5d","webpack:////Users/linglinglin/Desktop/uniapp/xsqua/components/cropping/cropping.vue?8bdb","webpack:////Users/linglinglin/Desktop/uniapp/xsqua/components/cropping/cropping.vue?1cd1","webpack:////Users/linglinglin/Desktop/uniapp/xsqua/components/cropping/cropping.vue?cb52","uni-app:///components/cropping/cropping.vue","webpack:////Users/linglinglin/Desktop/uniapp/xsqua/components/cropping/cropping.vue?858f","webpack:////Users/linglinglin/Desktop/uniapp/xsqua/components/cropping/cropping.vue?7a6e"],"names":["name","data","csH","sD","sT","pT","iS","sS","sO","bW","bD","tp","imgSrc","watch","avatarSrc","props","avatarStyle","selWidth","selHeight","expWidth","expHeight","minScale","maxScale","canScale","canRotate","lockWidth","lockHeight","stretch","lock","fileType","noTab","inner","quality","index","bgImage","created","uni","fail","success","complete","methods","fWindowResize","style","v","arr","obj","fSelect","setTimeout","count","sizeType","sourceType","title","mask","src","sH","showCancel","duration","fUpload","x","y","width","height","destWidth","destHeight","canvasId","r","avatar","path","base64","fPrvUpload","prvX","prvY","prvWidth","prvHeight","fDrawInit","allHeight","imgWidth","imgHeight","imgRadio","useWidth","useHeight","useRadio","sW","left","top","canvas","canvasOper","cc","cco","fDrawImage","cy","fPreview","radio","rHeight","ccp","fChooseImg","fRotate","fStart","touch0","touch1","fMove","fgDistance","scaleSize","beScaleSize","growY","l","t","b","right","bottom","cx","beX","beY","fEnd","fHideImg","fClose","fGetImgData","resolve","reject","fColorChange","tm_now","target","i","g","max","min","d","h","s","q","p","hK","tR","tG","tB","correctRGB","createRGB","a","btop","mime","bstr","n","u8arr","type"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAoI;AACpI;AAC4D;AACL;AACa;;;AAGpE;AACgN;AAChN,gBAAgB,iNAAU;AAC1B,EAAE,8EAAM;AACR,EAAE,kGAAM;AACR,EAAE,2GAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,sGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAs0B,CAAgB,syBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC0D70B;;AAAb;AAAA;EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA,eACA;EACAA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;QACAA;MACA;IACA;EACA;EACAC;IACAC;MACA;IACA;EACA;EACAC;IACAD;IACAE;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;EACA;EACAC;IAAA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;MACA;MACA;IACA;MACA;MACA;IACA;IAEA;MACA;IACA;MACAC;QACAC;UACA;QACA;QACAC;UACA;QACA;QACAC;UACA;QACA;MACA;IACA;EACA;EACAC;IACAC;MACA;MACA;MACA;MAMA;MASA;MACA;MACA;MAGA;MAKA;MAEA;MACA;QACAC;QACA;QAAA,2CACAA;UAAA;QAAA;UAAA;YAAA;YACA;YACAC;YACA;cACA;cACA;gBACA;gBACA;kBACAC;gBACA;cACA;cACAD;YACA;YACAE;UACA;QAAA;UAAA;QAAA;UAAA;QAAA;QACA;MACA;MAEA,kBACA;MACA,mBACA;MAEA;QACA;MACA;MACA;IACA;IACAC;MAAA;MACA;MACA;MACAC;QACA;MACA;MAEAX;QACAY;QACAC;QACAC;QACAZ;UAKAF;YACAe;YACAC;UACA;UAGA;UACAhB;YACAiB;YACAf;cACA;cACA;cACA;cACA;gBACA;gBACA;kBACA;oBACAgB;kBACAZ;kBACAA;kBACAA;kBACAA;gBACA;kBACAN;oBACAe;oBACAI;kBACA;kBACA;gBACA;gBACA;cACA;cAEA;gBACA;cACA;gBACAnB;kBACAG;oBACA;kBACA;gBACA;cACA;YACA;YACAF;cACAD;gBACAe;gBACAK;cACA;YACA;YACAjB;cACAH;YACA;UACA;QACA;MACA;IACA;IACAqB;MAAA;MACA;MACA;MACAV;QACA;MACA;MAEA;QACAW;QACAC;QACAC;QACAC;QACA1C;QACAC;MAMAgB;QACAe;QACAC;MACA;MAGA;MACA;MACA;MACA;MAmCAhB,yBACA;QACAsB;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAnC;QACAG;QACAM;UACA2B;UAcA;YACAC;YACAC;YACAlC;YACAhC;YACAmE;UACA;QAEA;QACA/B;UACAD;YACAe;YACAK;UACA;QACA;QACAjB;UACAH;UACA;UACA;QACA;MACA,GACA,KACA;IAEA;IACAiC;MAAA;MACA;MACA;MACAtB;QACA;MACA;MAEA;QACAe;QACAC;QACAO;QACAC;QACAC;QACAC;QACAtD;QACAC;MAMAgB;QACAe;QACAC;MACA;MAGA;MACA;MACA;MACA;MAmCAhB,yBACA;QACAsB;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAnC;QACAG;QACAM;UACA2B;UAaA;YACAC;YACAC;YACAlC;YACAhC;YACAmE;UACA;QAEA;QACA/B;UACAD;YACAe;YACAK;UACA;QACA;QACAjB;UACAH;UACA;UACA;QACA;MACA,GACA,KACA;IAEA;IACAsC;MAAA;MAAA;MACA;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACA5B;MAEA;MACA;MACA;MACA;MACA;QACA;UACA;UACA;QACA;UACA;UACA;QACA;UACA,yCACA;UACA;QACA;UACA,0CACA;UACA;QACA;UACA,oCACA;UACA;QACA;UACA,qCACA;UACA;MAAA;MAEA;QACA;UACA;UACA;QACA;UACA;UACA;QACA;UACA,yCACA;UACA;QACA;UACA,0CACA;UACA;QACA;UACA,oCACA;UACA;QACA;UACA,qCACA;UACA;MAAA;MAEA;QACAyB;QACAC;MACA;QACAA;QACAD;MACA;QACA;UACAA;UACAC;QACA;UACAD;QACA;MACA;QACA;UACAA;UACAC;QACA;UACAA;QACA;MACA;MACA;QACA;UACAD;UACAC;UACA;QACA;QACA;UACAA;UACAD;UACA;QACA;MACA;MAEA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MAEA;QACAI;QACAC;QACAxB;QACAC;QACAwB;QACAC;QACAC;QACAC;MAEAA;MACAA;MACAA;MACAA;MACAA;MAEAA;MACAA;MACAA;MACAA;MACAA;MACAA;MAEAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MAEAA;QACA;UACA;UACA;UACA;QACA;MACA;MACA;IACA;IACAC;MAAA;MACA;MACA;MACA;MAEA;QACAb;QACAC;MAMA;QAKAU;MAEA;QACAA;MACA;MAEA;QACA;UACAG;QAEAH;QACAA;QACAA;MACA;QACAA;QACAA;QACAA;MACA;MAEAA;IAKA;IACAI;MAAA;MACA;MACA;MACA5C;QACA;MACA;MAEA;QACAW;QACAC;QACAC;QACAC;MAMAzB;QACAe;QACAC;MACA;MAwDAhB,yBACA;QACAsB;QACAC;QACAC;QACAC;QACA1C;QACAC;QACA4C;QACAnC;QACAG;QACAM;UACA;UAEA;YACAgC;YACAC;UAWA;YACAE;YACAM;YACAC;YACAY;YACAC;UACA;YACArB;YACAC;UACA;YACAmB;YACApB;YACAC;UACA;UAEAqB;UACA;UACA;UACA;UACA;UACAA;UACAA;UASA;UACA;UACA;QACA;QACAzD;UACAD;YACAe;YACAK;UACA;QACA;QACAjB;UACAH;QACA;MACA,GACA,KACA;IAEA;IACA2D;MAAA;MAAA;MAAA;MACA;QACA;UACAzC;UACAnC;UACAC;UACAY;UACAR;UACAD;UACAF;UACAC;UACAK;UACAE;UACAE;UACAH;QAEAT;QACAC;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;UACA;UACA;QACA;UACA;UACA;QACA;QAEA;UACA8D;UACA5B;UACA;UACA;UACA;UACA;UACA;QACA;MACA;MACA;MACA;MACA;IACA;IACA0C;MACA;MACA;IACA;IACAC;MACA;QACAC;QACAC;MAEA;MACA;MAEA;QACA;UACAxC;QACA;MACA;IACA;IACAyC;MACA;QACAF;QACAC;MAEA;QACA;UACAxC;UACA0C;UACAC;UACAC;QAEA;UACA;UACA;UACA;UAEA;YACAC;UACA;YACA;cACA3B;cACA4B;cACAC;cACAzC;cACA0C;cACAxB;cACAC;cACAxB;cACAC;cACA+C;cACAC;cACAC;cACApB;YAEA;YACA;YACA;YACA;YACA;cACA;YACA;YACA;cACA;YACA;YACA;cACA;YACA;YACA;cACA;YACA;UACA;YACA;YACA;UACA;UAEA;QACA;QACA;QACA;UACAhC;UACAC;UACA;UACA;UACA;QACA;QAEA;MACA;QACA;UACAA;UACAoD;UACAC;QACA;UACA;YACAnC;YACA4B;YACAC;YACAzC;YACA0C;YACAxB;YACAC;YACAwB;YACAC;YACAC;YACApB;UAEA;UACA;UAEA;YACA;cACA;YACA;cACA;YACA;cACA;cACA;YACA;UACA;UACA;YACA;cACA;cACA;YACA;cACA;cACA;YACA;cACA;cACA;YACA;UACA;QACA;UACA;UACA;UACA;UACA;QACA;QAEA;QACA;MACA;IACA;IACAuB;MACA;QACAf;QACAC;MACA;QACA;MACA;QACA;QACA;MACA;IACA;IACAe;MACA;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACAC;MAAA;MACA;QACA;UACA7C;UACAC;UACAC;QAmBArC,uBACA;UACA4B;UACAN;UACAC;UACAC;UACAC;UACAvB;YACA+E;UACA;UACAhF;YACAiF;UACA;QACA,GACA,OACA;MAEA;IACA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACAC;gBAAA,MACAA;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBACA;gBAMApF;kBACAe;kBACAC;gBACA;gBAAA,IAGA;kBAAA;kBAAA;gBAAA;gBAAA;gBAAA,OAEA;kBACAhB;oBACAe;oBACAK;kBACA;gBACA;cAAA;gBAAA,IALA;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBASA;cAAA;gBAGAvD,0BACAwH,wBACAC;gBAmBA;kBACAD;gBACA;kBACAC;kBACA;kBACA;kBACA;oBACAzD;oBACA0D;oBACAhB;oBACAiB;oBACAC;oBACAC;oBACA;sBACAC;oBACA;sBACAA;oBACA;sBACAA;oBACA;sBACAA;oBACA;sBACAA;oBACA;oBACAtB;oBACA;sBACAuB;oBACA;sBACAA;oBACA;sBACAA;oBACA;oBACA/H;oBAEA;sBACA+H;oBACA;sBACAA;oBACA;oBAEA;sBACA/D;oBACA;sBACA;wBACAgE;sBACA;wBACAA;sBACA;sBACAC;sBACAC;sBACAC;sBACAC;sBACAC;sBACAC;wBACA;0BACA;wBACA;wBACA;0BACA;wBACA;wBACA;sBACA;sBACAC;wBACA;0BACA;wBACA;0BACA;wBACA;0BACA;wBACA;wBACA;sBACA;sBACAvE;sBACA0D;sBACAhB;oBACA;oBACA8B;oBACAhB;oBACAA;oBACAA;kBACA;gBACA;gBAEAnD,oBACAC,oBACAC,4BACAC;gBAyBArC,uBACA;kBACA4B;kBACAN;kBACAC;kBACAC;kBACAC;kBACA5D;kBACAoC;oBACAD;sBACAe;sBACAK;oBACA;kBACA;kBACAjB;oBACAH;kBACA;gBACA,GACA,OACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IACAsG;MACA;MACA;QACA;UACAC;UACAC;UACAC;UACAC;QACA;UACAA;QACA;QACA,eACA,iDACA;UACAC;QACA,GACA,CACA;MACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;AC3yCA;AAAA;AAAA;AAAA;AAAmrC,CAAgB,mmCAAG,EAAC,C;;;;;;;;;;;ACAvsC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"components/cropping/cropping.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./cropping.vue?vue&type=template&id=540de778&name=yq-avatar&\"\nvar renderjs\nimport script from \"./cropping.vue?vue&type=script&lang=js&\"\nexport * from \"./cropping.vue?vue&type=script&lang=js&\"\nimport style0 from \"./cropping.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"components/cropping/cropping.vue\"\nexport default component.exports","export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cropping.vue?vue&type=template&id=540de778&name=yq-avatar&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cropping.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cropping.vue?vue&type=script&lang=js&\"","<template name=\"yq-avatar\">\n\t<view>\n\t\t<!-- \t<image :src=\"imgSrc.imgSrc\" @click=\"fSelect\" :style=\"[iS]\" class=\"my-avatar\"></image> -->\n\t\t<canvas\n\t\t\tcanvas-id=\"avatar-canvas\"\n\t\t\tid=\"avatar-canvas\"\n\t\t\tclass=\"my-canvas\"\n\t\t\t:style=\"{ top: sT, height: csH }\"\n\t\t\tdisable-scroll=\"false\"\n\t\t></canvas>\n\t\t<canvas\n\t\t\tcanvas-id=\"oper-canvas\"\n\t\t\tid=\"oper-canvas\"\n\t\t\tclass=\"oper-canvas\"\n\t\t\t:style=\"{ top: sT, height: csH }\"\n\t\t\tdisable-scroll=\"false\"\n\t\t\t@touchstart=\"fStart\"\n\t\t\t@touchmove=\"fMove\"\n\t\t\t@touchend=\"fEnd\"\n\t\t></canvas>\n\t\t<canvas\n\t\t\tcanvas-id=\"prv-canvas\"\n\t\t\tid=\"prv-canvas\"\n\t\t\tclass=\"prv-canvas\"\n\t\t\tdisable-scroll=\"false\"\n\t\t\t@touchstart=\"fHideImg\"\n\t\t\t:style=\"{ height: csH, top: pT }\"\n\t\t></canvas>\n\t\t<view class=\"oper-wrapper\" :style=\"{ display: sD, top: tp }\">\n\t\t\t<view class=\"oper\">\n\t\t\t\t<view class=\"btn-wrapper\" v-if=\"sO\">\n\t\t\t\t\t<view @click=\"fSelect\" hover-class=\"hover\" :style=\"{ width: bW }\"><text>重选</text></view>\n\t\t\t\t\t<view @click=\"fClose\" hover-class=\"hover\" :style=\"{ width: bW }\"><text>取消</text></view>\n\t\t\t\t\t<view @click=\"fRotate\" hover-class=\"hover\" :style=\"{ width: bW, display: bD }\"><text>旋转</text></view>\n\t\t\t\t\t<!-- \t<view @click=\"fPreview\" hover-class=\"hover\" :style=\"{ width: bW }\"><text>预览</text></view> -->\n\t\t\t\t\t<view @click=\"fUpload\" hover-class=\"hover\" :style=\"{ width: bW }\"><text>上传</text></view>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"clr-wrapper\" v-else>\n\t\t\t\t\t<slider\n\t\t\t\t\t\tclass=\"my-slider\"\n\t\t\t\t\t\t@change=\"fColorChange\"\n\t\t\t\t\t\tblock-size=\"25\"\n\t\t\t\t\t\tvalue=\"0\"\n\t\t\t\t\t\tmin=\"-100\"\n\t\t\t\t\t\tmax=\"100\"\n\t\t\t\t\t\tactiveColor=\"red\"\n\t\t\t\t\t\tbackgroundColor=\"green\"\n\t\t\t\t\t\tblock-color=\"grey\"\n\t\t\t\t\t\tshow-value\n\t\t\t\t\t></slider>\n\t\t\t\t\t<view @click=\"fPrvUpload\" hover-class=\"hover\" :style=\"{ width: bW }\"><text>上传</text></view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t</view>\n</template>\n\n<script>\n'use strict';\nconst tH = 50;\nexport default {\n\tname: 'cropping',\n\tdata() {\n\t\treturn {\n\t\t\tcsH: '0px',\n\t\t\tsD: 'none',\n\t\t\tsT: '-10000px',\n\t\t\tpT: '-10000px',\n\t\t\tiS: {},\n\t\t\tsS: {},\n\t\t\tsO: true,\n\t\t\tbW: '19%',\n\t\t\tbD: 'flex',\n\t\t\ttp: 0,\n\t\t\timgSrc: {\n\t\t\t\timgSrc: ''\n\t\t\t}\n\t\t};\n\t},\n\twatch: {\n\t\tavatarSrc() {\n\t\t\tthis.imgSrc.imgSrc = this.avatarSrc;\n\t\t}\n\t},\n\tprops: {\n\t\tavatarSrc: '',\n\t\tavatarStyle: '',\n\t\tselWidth: '',\n\t\tselHeight: '',\n\t\texpWidth: '',\n\t\texpHeight: '',\n\t\tminScale: '',\n\t\tmaxScale: '',\n\t\tcanScale: '',\n\t\tcanRotate: '',\n\t\tlockWidth: '',\n\t\tlockHeight: '',\n\t\tstretch: '',\n\t\tlock: '',\n\t\tfileType: '',\n\t\tnoTab: '',\n\t\tinner: '',\n\t\tquality: '',\n\t\tindex: '',\n\t\tbgImage: ''\n\t},\n\tcreated() {\n\t\tthis.cc = uni.createCanvasContext('avatar-canvas', this);\n\t\tthis.cco = uni.createCanvasContext('oper-canvas', this);\n\t\tthis.ccp = uni.createCanvasContext('prv-canvas', this);\n\t\tthis.qlty = parseFloat(this.quality) || 1;\n\t\tthis.imgSrc.imgSrc = this.avatarSrc;\n\t\tthis.letRotate = this.canRotate === false || this.inner === true || this.inner === 'true' || this.canRotate === 'false' ? 0 : 1;\n\t\tthis.letScale = this.canScale === false || this.canScale === 'false' ? 0 : 1;\n\t\tthis.isin = this.inner === true || this.inner === 'true' ? 1 : 0;\n\t\tthis.indx = this.index || undefined;\n\t\tthis.mnScale = parseFloat(this.minScale) || 0.3;\n\t\tthis.mxScale = parseFloat(this.maxScale) || 4;\n\t\tthis.noBar = this.noTab === true || this.noTab === 'true' ? 1 : 0;\n\t\tthis.stc = this.stretch;\n\t\tthis.lck = this.lock;\n\t\tthis.fType = this.fileType === 'jpg' ? 'jpg' : 'png';\n\t\tif (this.isin || !this.letRotate) {\n\t\t\tthis.bW = '24%';\n\t\t\tthis.bD = 'none';\n\t\t} else {\n\t\t\tthis.bW = '19%';\n\t\t\tthis.bD = 'flex';\n\t\t}\n\n\t\tif (this.noBar) {\n\t\t\tthis.fWindowResize();\n\t\t} else {\n\t\t\tuni.showTabBar({\n\t\t\t\tfail: () => {\n\t\t\t\t\tthis.noBar = 1;\n\t\t\t\t},\n\t\t\t\tsuccess: () => {\n\t\t\t\t\tthis.noBar = 0;\n\t\t\t\t},\n\t\t\t\tcomplete: res => {\n\t\t\t\t\tthis.fWindowResize();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\tmethods: {\n\t\tfWindowResize() {\n\t\t\tlet sysInfo = uni.getSystemInfoSync();\n\t\t\tthis.platform = sysInfo.platform;\n\t\t\tthis.wW = sysInfo.windowWidth;\n\n\t\t\t// #ifdef H5\n\t\t\tthis.drawTop = sysInfo.windowTop;\n\t\t\t// #endif\n\t\t\t// #ifndef H5\n\t\t\tthis.drawTop = 0;\n\t\t\t// #endif\n\n\t\t\t// #ifdef MP-ALIPAY\n\t\t\tthis.wH = sysInfo.screenHeight - sysInfo.statusBarHeight - sysInfo.titleBarHeight;\n\t\t\tthis.csH = this.wH - tH + 'px';\n\t\t\t// #endif\n\n\t\t\t// #ifndef MP-ALIPAY\n\t\t\tthis.wH = sysInfo.windowHeight;\n\t\t\tif (!this.noBar) this.wH += tH;\n\t\t\tthis.csH = this.wH - tH + 'px';\n\t\t\t// #endif\n\n\t\t\tthis.tp = this.csH;\n\t\t\t// #ifdef H5\n\t\t\tthis.tp = sysInfo.windowTop + parseInt(this.csH) + 'px';\n\t\t\t// #endif\n\n\t\t\tthis.pxRatio = this.wW / 750;\n\n\t\t\tlet style = this.avatarStyle;\n\t\t\tif (style && style !== true && (style = style.trim())) {\n\t\t\t\tstyle = style.split(';');\n\t\t\t\tlet obj = {};\n\t\t\t\tfor (let v of style) {\n\t\t\t\t\tif (!v) continue;\n\t\t\t\t\tv = v.trim().split(':');\n\t\t\t\t\tif (v[1].toString().indexOf('upx') >= 0) {\n\t\t\t\t\t\tlet arr = v[1].trim().split(' ');\n\t\t\t\t\t\tfor (let k in arr) {\n\t\t\t\t\t\t\tif (!arr[k]) continue;\n\t\t\t\t\t\t\tif (arr[k].toString().indexOf('upx') >= 0) {\n\t\t\t\t\t\t\t\tarr[k] = parseFloat(arr[k]) * this.pxRatio + 'px';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tv[1] = arr.join(' ');\n\t\t\t\t\t}\n\t\t\t\t\tobj[v[0].trim()] = v[1].trim();\n\t\t\t\t}\n\t\t\t\tthis.iS = obj;\n\t\t\t}\n\n\t\t\tthis.expWidth &&\n\t\t\t\t(this.eW = this.expWidth.toString().indexOf('upx') >= 0 ? parseInt(this.expWidth) * this.pxRatio : parseInt(this.expWidth));\n\t\t\tthis.expHeight &&\n\t\t\t\t(this.eH = this.expHeight.toString().indexOf('upx') >= 0 ? parseInt(this.expHeight) * this.pxRatio : parseInt(this.expHeight));\n\n\t\t\tif (this.sD === 'flex') {\n\t\t\t\tthis.fDrawInit(true);\n\t\t\t}\n\t\t\tthis.fHideImg();\n\t\t},\n\t\tfSelect() {\n\t\t\tif (this.fSelecting) return;\n\t\t\tthis.fSelecting = true;\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.fSelecting = false;\n\t\t\t}, 500);\n\n\t\t\tuni.chooseImage({\n\t\t\t\tcount: 1,\n\t\t\t\tsizeType: ['original', 'compressed'],\n\t\t\t\tsourceType: ['album', 'camera'],\n\t\t\t\tsuccess: r => {\n\t\t\t\t\t// #ifdef MP-ALIPAY\n\t\t\t\t\tuni.showLoading();\n\t\t\t\t\t// #endif\n\t\t\t\t\t// #ifndef MP-ALIPAY\n\t\t\t\t\tuni.showLoading({\n\t\t\t\t\t\ttitle: '加载中...',\n\t\t\t\t\t\tmask: true\n\t\t\t\t\t});\n\t\t\t\t\t// #endif\n\n\t\t\t\t\tlet path = (this.imgPath = r.tempFilePaths[0]);\n\t\t\t\t\tuni.getImageInfo({\n\t\t\t\t\t\tsrc: path,\n\t\t\t\t\t\tsuccess: r => {\n\t\t\t\t\t\t\tthis.imgWidth = r.width;\n\t\t\t\t\t\t\tthis.imgHeight = r.height;\n\t\t\t\t\t\t\tthis.path = path;\n\t\t\t\t\t\t\tif (!this.hasSel) {\n\t\t\t\t\t\t\t\tlet style = this.sS || {};\n\t\t\t\t\t\t\t\tif (this.selWidth && this.selHeight) {\n\t\t\t\t\t\t\t\t\tlet sW = this.selWidth.toString().indexOf('upx') >= 0 ? parseInt(this.selWidth) * this.pxRatio : parseInt(this.selWidth),\n\t\t\t\t\t\t\t\t\t\tsH = this.selHeight.toString().indexOf('upx') >= 0 ? parseInt(this.selHeight) * this.pxRatio : parseInt(this.selHeight);\n\t\t\t\t\t\t\t\t\tstyle.width = sW + 'px';\n\t\t\t\t\t\t\t\t\tstyle.height = sH + 'px';\n\t\t\t\t\t\t\t\t\tstyle.top = ((this.wH - sH - tH) | 0) / 2 + 'px';\n\t\t\t\t\t\t\t\t\tstyle.left = ((this.wW - sW) | 0) / 2 + 'px';\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\t\t\t\t\ttitle: '裁剪框的宽或高没有设置',\n\t\t\t\t\t\t\t\t\t\tshowCancel: false\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthis.sS = style;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (this.noBar) {\n\t\t\t\t\t\t\t\tthis.fDrawInit(true);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tuni.hideTabBar({\n\t\t\t\t\t\t\t\t\tcomplete: () => {\n\t\t\t\t\t\t\t\t\t\tthis.fDrawInit(true);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tfail: () => {\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: '请选择正确图片',\n\t\t\t\t\t\t\t\tduration: 2000\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomplete() {\n\t\t\t\t\t\t\tuni.hideLoading();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tfUpload() {\n\t\t\tif (this.fUploading) return;\n\t\t\tthis.fUploading = true;\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.fUploading = false;\n\t\t\t}, 1000);\n\n\t\t\tlet style = this.sS,\n\t\t\t\tx = parseInt(style.left),\n\t\t\t\ty = parseInt(style.top),\n\t\t\t\twidth = parseInt(style.width),\n\t\t\t\theight = parseInt(style.height),\n\t\t\t\texpWidth = this.eW || width * this.pixelRatio,\n\t\t\t\texpHeight = this.eH || height * this.pixelRatio;\n\n\t\t\t// #ifdef MP-ALIPAY\n\t\t\tuni.showLoading();\n\t\t\t// #endif\n\t\t\t// #ifndef MP-ALIPAY\n\t\t\tuni.showLoading({\n\t\t\t\ttitle: '加载中...',\n\t\t\t\tmask: true\n\t\t\t});\n\t\t\t// #endif\n\n\t\t\tthis.sD = 'none';\n\t\t\tthis.sT = '-10000px';\n\t\t\tthis.hasSel = false;\n\t\t\tthis.fHideImg();\n\t\t\t// #ifdef MP-ALIPAY\n\t\t\tthis.cc.toTempFilePath({\n\t\t\t\tx: x,\n\t\t\t\ty: y,\n\t\t\t\twidth: width,\n\t\t\t\theight: height,\n\t\t\t\tdestWidth: expWidth,\n\t\t\t\tdestHeight: expHeight,\n\t\t\t\tfileType: this.fType,\n\t\t\t\tquality: this.qlty,\n\t\t\t\tsuccess: r => {\n\t\t\t\t\tr = r.apFilePath;\n\t\t\t\t\tthis.$emit('upload', {\n\t\t\t\t\t\tavatar: this.imgSrc,\n\t\t\t\t\t\tpath: r,\n\t\t\t\t\t\tindex: this.indx,\n\t\t\t\t\t\tdata: this.rtn,\n\t\t\t\t\t\tbase64: this.base64 || null\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tfail: res => {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: 'error1',\n\t\t\t\t\t\tduration: 2000\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tcomplete: () => {\n\t\t\t\t\tuni.hideLoading();\n\t\t\t\t\tthis.noBar || uni.showTabBar();\n\t\t\t\t\tthis.$emit('end');\n\t\t\t\t}\n\t\t\t});\n\t\t\t// #endif\n\t\t\t// #ifndef MP-ALIPAY\n\t\t\tuni.canvasToTempFilePath(\n\t\t\t\t{\n\t\t\t\t\tx: x,\n\t\t\t\t\ty: y,\n\t\t\t\t\twidth: width,\n\t\t\t\t\theight: height,\n\t\t\t\t\tdestWidth: expWidth,\n\t\t\t\t\tdestHeight: expHeight,\n\t\t\t\t\tcanvasId: 'avatar-canvas',\n\t\t\t\t\tfileType: this.fType,\n\t\t\t\t\tquality: this.qlty,\n\t\t\t\t\tsuccess: r => {\n\t\t\t\t\t\tr = r.tempFilePath;\n\t\t\t\t\t\t// #ifdef H5\n\t\t\t\t\t\tthis.btop(r).then(r => {\n\t\t\t\t\t\t\tthis.$emit('upload', {\n\t\t\t\t\t\t\t\tavatar: this.imgSrc,\n\t\t\t\t\t\t\t\tpath: r,\n\t\t\t\t\t\t\t\tindex: this.indx,\n\t\t\t\t\t\t\t\tdata: this.rtn,\n\t\t\t\t\t\t\t\tbase64: this.base64 || null\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t});\n\t\t\t\t\t\t// #endif\n\t\t\t\t\t\t// #ifndef H5\n\t\t\t\t\t\tthis.$emit('upload', {\n\t\t\t\t\t\t\tavatar: this.imgSrc,\n\t\t\t\t\t\t\tpath: r,\n\t\t\t\t\t\t\tindex: this.indx,\n\t\t\t\t\t\t\tdata: this.rtn,\n\t\t\t\t\t\t\tbase64: this.base64 || null\n\t\t\t\t\t\t});\n\t\t\t\t\t\t// #endif\n\t\t\t\t\t},\n\t\t\t\t\tfail: res => {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: 'error1',\n\t\t\t\t\t\t\tduration: 2000\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tcomplete: () => {\n\t\t\t\t\t\tuni.hideLoading();\n\t\t\t\t\t\tthis.noBar || uni.showTabBar();\n\t\t\t\t\t\tthis.$emit('end');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tthis\n\t\t\t);\n\t\t\t// #endif\n\t\t},\n\t\tfPrvUpload() {\n\t\t\tif (this.fPrvUploading) return;\n\t\t\tthis.fPrvUploading = true;\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.fPrvUploading = false;\n\t\t\t}, 1000);\n\n\t\t\tlet style = this.sS,\n\t\t\t\tdestWidth = parseInt(style.width),\n\t\t\t\tdestHeight = parseInt(style.height),\n\t\t\t\tprvX = this.prvX,\n\t\t\t\tprvY = this.prvY,\n\t\t\t\tprvWidth = this.prvWidth,\n\t\t\t\tprvHeight = this.prvHeight,\n\t\t\t\texpWidth = this.eW || parseInt(style.width) * this.pixelRatio,\n\t\t\t\texpHeight = this.eH || parseInt(style.height) * this.pixelRatio;\n\n\t\t\t// #ifdef MP-ALIPAY\n\t\t\tuni.showLoading();\n\t\t\t// #endif\n\t\t\t// #ifndef MP-ALIPAY\n\t\t\tuni.showLoading({\n\t\t\t\ttitle: '加载中...',\n\t\t\t\tmask: true\n\t\t\t});\n\t\t\t// #endif\n\n\t\t\tthis.sD = 'none';\n\t\t\tthis.sT = '-10000px';\n\t\t\tthis.hasSel = false;\n\t\t\tthis.fHideImg();\n\t\t\t// #ifdef MP-ALIPAY\n\t\t\tthis.ccp.toTempFilePath({\n\t\t\t\tx: prvX,\n\t\t\t\ty: prvY,\n\t\t\t\twidth: prvWidth,\n\t\t\t\theight: prvHeight,\n\t\t\t\tdestWidth: expWidth,\n\t\t\t\tdestHeight: expHeight,\n\t\t\t\tfileType: this.fType,\n\t\t\t\tquality: this.qlty,\n\t\t\t\tsuccess: r => {\n\t\t\t\t\tr = r.apFilePath;\n\t\t\t\t\tthis.$emit('upload', {\n\t\t\t\t\t\tavatar: this.imgSrc,\n\t\t\t\t\t\tpath: r,\n\t\t\t\t\t\tindex: this.indx,\n\t\t\t\t\t\tdata: this.rtn,\n\t\t\t\t\t\tbase64: this.base64 || null\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tfail: () => {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: 'error_prv',\n\t\t\t\t\t\tduration: 2000\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tcomplete: () => {\n\t\t\t\t\tuni.hideLoading();\n\t\t\t\t\tthis.noBar || uni.showTabBar();\n\t\t\t\t\tthis.$emit('end');\n\t\t\t\t}\n\t\t\t});\n\t\t\t// #endif\n\t\t\t// #ifndef MP-ALIPAY\n\t\t\tuni.canvasToTempFilePath(\n\t\t\t\t{\n\t\t\t\t\tx: prvX,\n\t\t\t\t\ty: prvY,\n\t\t\t\t\twidth: prvWidth,\n\t\t\t\t\theight: prvHeight,\n\t\t\t\t\tdestWidth: expWidth,\n\t\t\t\t\tdestHeight: expHeight,\n\t\t\t\t\tcanvasId: 'prv-canvas',\n\t\t\t\t\tfileType: this.fType,\n\t\t\t\t\tquality: this.qlty,\n\t\t\t\t\tsuccess: r => {\n\t\t\t\t\t\tr = r.tempFilePath;\n\t\t\t\t\t\t// #ifdef H5\n\t\t\t\t\t\tthis.btop(r).then(r => {\n\t\t\t\t\t\t\tthis.$emit('upload', {\n\t\t\t\t\t\t\t\tavatar: this.imgSrc,\n\t\t\t\t\t\t\t\tpath: r,\n\t\t\t\t\t\t\t\tindex: this.indx,\n\t\t\t\t\t\t\t\tdata: this.rtn,\n\t\t\t\t\t\t\t\tbase64: this.base64 || null\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t\t// #endif\n\t\t\t\t\t\t// #ifndef H5\n\t\t\t\t\t\tthis.$emit('upload', {\n\t\t\t\t\t\t\tavatar: this.imgSrc,\n\t\t\t\t\t\t\tpath: r,\n\t\t\t\t\t\t\tindex: this.indx,\n\t\t\t\t\t\t\tdata: this.rtn,\n\t\t\t\t\t\t\tbase64: this.base64 || null\n\t\t\t\t\t\t});\n\t\t\t\t\t\t// #endif\n\t\t\t\t\t},\n\t\t\t\t\tfail: () => {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: 'error_prv',\n\t\t\t\t\t\t\tduration: 2000\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tcomplete: () => {\n\t\t\t\t\t\tuni.hideLoading();\n\t\t\t\t\t\tthis.noBar || uni.showTabBar();\n\t\t\t\t\t\tthis.$emit('end');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tthis\n\t\t\t);\n\t\t\t// #endif\n\t\t},\n\t\tfDrawInit(ini = false) {\n\t\t\tlet allWidth = this.wW,\n\t\t\t\tallHeight = this.wH,\n\t\t\t\timgWidth = this.imgWidth,\n\t\t\t\timgHeight = this.imgHeight,\n\t\t\t\timgRadio = imgWidth / imgHeight,\n\t\t\t\tuseWidth = allWidth - 40,\n\t\t\t\tuseHeight = allHeight - tH - 80,\n\t\t\t\tuseRadio = useWidth / useHeight,\n\t\t\t\tsW = parseInt(this.sS.width),\n\t\t\t\tsH = parseInt(this.sS.height);\n\n\t\t\tthis.fixWidth = 0;\n\t\t\tthis.fixHeight = 0;\n\t\t\tthis.lckWidth = 0;\n\t\t\tthis.lckHeight = 0;\n\t\t\tswitch (this.stc) {\n\t\t\t\tcase 'x':\n\t\t\t\t\tthis.fixWidth = 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'y':\n\t\t\t\t\tthis.fixHeight = 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'long':\n\t\t\t\t\tif (imgRadio > 1) this.fixWidth = 1;\n\t\t\t\t\telse this.fixHeight = 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'short':\n\t\t\t\t\tif (imgRadio > 1) this.fixHeight = 1;\n\t\t\t\t\telse this.fixWidth = 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'longSel':\n\t\t\t\t\tif (sW > sH) this.fixWidth = 1;\n\t\t\t\t\telse this.fixHeight = 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'shortSel':\n\t\t\t\t\tif (sW > sH) this.fixHeight = 1;\n\t\t\t\t\telse this.fixWidth = 1;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tswitch (this.lck) {\n\t\t\t\tcase 'x':\n\t\t\t\t\tthis.lckWidth = 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'y':\n\t\t\t\t\tthis.lckHeight = 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'long':\n\t\t\t\t\tif (imgRadio > 1) this.lckWidth = 1;\n\t\t\t\t\telse this.lckHeight = 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'short':\n\t\t\t\t\tif (imgRadio > 1) this.lckHeight = 1;\n\t\t\t\t\telse this.lckWidth = 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'longSel':\n\t\t\t\t\tif (sW > sH) this.lckWidth = 1;\n\t\t\t\t\telse this.lckHeight = 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'shortSel':\n\t\t\t\t\tif (sW > sH) this.lckHeight = 1;\n\t\t\t\t\telse this.lckWidth = 1;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (this.fixWidth) {\n\t\t\t\tuseWidth = sW;\n\t\t\t\tuseHeight = useWidth / imgRadio;\n\t\t\t} else if (this.fixHeight) {\n\t\t\t\tuseHeight = sH;\n\t\t\t\tuseWidth = useHeight * imgRadio;\n\t\t\t} else if (imgRadio < useRadio) {\n\t\t\t\tif (imgHeight < useHeight) {\n\t\t\t\t\tuseWidth = imgWidth;\n\t\t\t\t\tuseHeight = imgHeight;\n\t\t\t\t} else {\n\t\t\t\t\tuseWidth = useHeight * imgRadio;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (imgWidth < useWidth) {\n\t\t\t\t\tuseWidth = imgWidth;\n\t\t\t\t\tuseHeight = imgHeight;\n\t\t\t\t} else {\n\t\t\t\t\tuseHeight = useWidth / imgRadio;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.isin) {\n\t\t\t\tif (useWidth < sW) {\n\t\t\t\t\tuseWidth = sW;\n\t\t\t\t\tuseHeight = useWidth / imgRadio;\n\t\t\t\t\tthis.lckHeight = 0;\n\t\t\t\t}\n\t\t\t\tif (useHeight < sH) {\n\t\t\t\t\tuseHeight = sH;\n\t\t\t\t\tuseWidth = useHeight * imgRadio;\n\t\t\t\t\tthis.lckWidth = 0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.scaleSize = 1;\n\t\t\tthis.rotateDeg = 0;\n\t\t\tthis.posWidth = ((allWidth - useWidth) / 2) | 0;\n\t\t\tthis.posHeight = ((allHeight - useHeight - tH) / 2) | 0;\n\t\t\tthis.useWidth = useWidth | 0;\n\t\t\tthis.useHeight = useHeight | 0;\n\t\t\tthis.centerX = this.posWidth + useWidth / 2;\n\t\t\tthis.centerY = this.posHeight + useHeight / 2;\n\t\t\tthis.focusX = 0;\n\t\t\tthis.focusY = 0;\n\n\t\t\tlet style = this.sS,\n\t\t\t\tleft = parseInt(style.left),\n\t\t\t\ttop = parseInt(style.top),\n\t\t\t\twidth = parseInt(style.width),\n\t\t\t\theight = parseInt(style.height),\n\t\t\t\tcanvas = this.canvas,\n\t\t\t\tcanvasOper = this.canvasOper,\n\t\t\t\tcc = this.cc,\n\t\t\t\tcco = this.cco;\n\n\t\t\tcco.beginPath();\n\t\t\tcco.setLineWidth(3);\n\t\t\tcco.setGlobalAlpha(1);\n\t\t\tcco.setStrokeStyle('white');\n\t\t\tcco.strokeRect(left, top, width, height);\n\n\t\t\tcco.setFillStyle('black');\n\t\t\tcco.setGlobalAlpha(0.5);\n\t\t\tcco.fillRect(0, 0, this.wW, top);\n\t\t\tcco.fillRect(0, top, left, height);\n\t\t\tcco.fillRect(0, top + height, this.wW, this.wH - height - top - tH);\n\t\t\tcco.fillRect(left + width, top, this.wW - width - left, height);\n\n\t\t\tcco.setGlobalAlpha(1);\n\t\t\tcco.setStrokeStyle('red');\n\t\t\tcco.moveTo(left + 15, top);\n\t\t\tcco.lineTo(left, top);\n\t\t\tcco.lineTo(left, top + 15);\n\t\t\tcco.moveTo(left + width - 15, top);\n\t\t\tcco.lineTo(left + width, top);\n\t\t\tcco.lineTo(left + width, top + 15);\n\t\t\tcco.moveTo(left + 15, top + height);\n\t\t\tcco.lineTo(left, top + height);\n\t\t\tcco.lineTo(left, top + height - 15);\n\t\t\tcco.moveTo(left + width - 15, top + height);\n\t\t\tcco.lineTo(left + width, top + height);\n\t\t\tcco.lineTo(left + width, top + height - 15);\n\t\t\tcco.stroke();\n\n\t\t\tcco.draw(false, () => {\n\t\t\t\tif (ini) {\n\t\t\t\t\tthis.sD = 'flex';\n\t\t\t\t\tthis.sT = this.drawTop + 'px';\n\t\t\t\t\tthis.fDrawImage(true);\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.$emit('init');\n\t\t},\n\t\tfDrawImage(ini = false) {\n\t\t\tlet tm_now = Date.now();\n\t\t\tif (tm_now - this.drawTm < 20) return;\n\t\t\tthis.drawTm = tm_now;\n\n\t\t\tlet cc = this.cc,\n\t\t\t\timgWidth = this.useWidth * this.scaleSize,\n\t\t\t\timgHeight = this.useHeight * this.scaleSize;\n\n\t\t\t// #ifdef MP-ALIPAY\n\t\t\tcc.save();\n\t\t\t// #endif\n\n\t\t\tif (this.bgImage) {\n\t\t\t\t// #ifdef MP-ALIPAY\n\t\t\t\tcc.clearRect(0, 0, this.wW, this.wH - tH);\n\t\t\t\t// #endif\n\t\t\t\t// #ifndef MP-ALIPAY\n\t\t\t\tcc.drawImage(this.bgImage, 0, 0, this.wW, this.wH - tH);\n\t\t\t\t// #endif\n\t\t\t} else {\n\t\t\t\tcc.fillRect(0, 0, this.wW, this.wH - tH);\n\t\t\t}\n\n\t\t\tif (this.isin) {\n\t\t\t\tlet cx = this.focusX * (this.scaleSize - 1),\n\t\t\t\t\tcy = this.focusY * (this.scaleSize - 1);\n\n\t\t\t\tcc.translate(this.centerX, this.centerY);\n\t\t\t\tcc.rotate((this.rotateDeg * Math.PI) / 180);\n\t\t\t\tcc.drawImage(this.imgPath, this.posWidth - this.centerX - cx, this.posHeight - this.centerY - cy, imgWidth, imgHeight);\n\t\t\t} else {\n\t\t\t\tcc.translate(this.posWidth + imgWidth / 2, this.posHeight + imgHeight / 2);\n\t\t\t\tcc.rotate((this.rotateDeg * Math.PI) / 180);\n\t\t\t\tcc.drawImage(this.imgPath, -imgWidth / 2, -imgHeight / 2, imgWidth, imgHeight);\n\t\t\t}\n\n\t\t\tcc.draw(false);\n\n\t\t\t// #ifdef MP-ALIPAY\n\t\t\tcc.restore();\n\t\t\t// #endif\n\t\t},\n\t\tfPreview() {\n\t\t\tif (this.fPreviewing) return;\n\t\t\tthis.fPreviewing = true;\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.fPreviewing = false;\n\t\t\t}, 1000);\n\n\t\t\tlet style = this.sS,\n\t\t\t\tx = parseInt(style.left),\n\t\t\t\ty = parseInt(style.top),\n\t\t\t\twidth = parseInt(style.width),\n\t\t\t\theight = parseInt(style.height);\n\n\t\t\t// #ifdef MP-ALIPAY\n\t\t\tuni.showLoading();\n\t\t\t// #endif\n\t\t\t// #ifndef MP-ALIPAY\n\t\t\tuni.showLoading({\n\t\t\t\ttitle: '加载中...',\n\t\t\t\tmask: true\n\t\t\t});\n\t\t\t// #endif\n\n\t\t\t// #ifdef MP-ALIPAY\n\t\t\tthis.cc.toTempFilePath({\n\t\t\t\tx: x,\n\t\t\t\ty: y,\n\t\t\t\twidth: width,\n\t\t\t\theight: height,\n\t\t\t\texpWidth: width * this.pixelRatio,\n\t\t\t\texpHeight: height * this.pixelRatio,\n\t\t\t\tfileType: this.fType,\n\t\t\t\tquality: this.qlty,\n\t\t\t\tsuccess: r => {\n\t\t\t\t\tthis.prvImgTmp = r = r.apFilePath;\n\t\t\t\t\tlet ccp = this.ccp,\n\t\t\t\t\t\tprvX = this.wW,\n\t\t\t\t\t\tprvY = parseInt(this.csH),\n\t\t\t\t\t\tprvWidth = parseInt(this.sS.width),\n\t\t\t\t\t\tprvHeight = parseInt(this.sS.height),\n\t\t\t\t\t\tuseWidth = prvX - 40,\n\t\t\t\t\t\tuseHeight = prvY - 80,\n\t\t\t\t\t\tradio = useWidth / prvWidth,\n\t\t\t\t\t\trHeight = prvHeight * radio;\n\t\t\t\t\tif (rHeight < useHeight) {\n\t\t\t\t\t\tprvWidth = useWidth;\n\t\t\t\t\t\tprvHeight = rHeight;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tradio = useHeight / prvHeight;\n\t\t\t\t\t\tprvWidth *= radio;\n\t\t\t\t\t\tprvHeight = useHeight;\n\t\t\t\t\t}\n\t\t\t\t\tccp.fillRect(0, 0, prvX, prvY);\n\t\t\t\t\tthis.prvX = prvX = ((prvX - prvWidth) / 2) | 0;\n\t\t\t\t\tthis.prvY = prvY = ((prvY - prvHeight) / 2) | 0;\n\t\t\t\t\tthis.prvWidth = prvWidth = prvWidth | 0;\n\t\t\t\t\tthis.prvHeight = prvHeight = prvHeight | 0;\n\t\t\t\t\tccp.drawImage(r, prvX, prvY, prvWidth, prvHeight);\n\t\t\t\t\tccp.draw(false);\n\n\t\t\t\t\tthis.sO = false;\n\t\t\t\t\tthis.pT = '0';\n\t\t\t\t},\n\t\t\t\tfail: () => {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: 'error2',\n\t\t\t\t\t\tduration: 2000\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tcomplete: () => {\n\t\t\t\t\tuni.hideLoading();\n\t\t\t\t}\n\t\t\t});\n\t\t\t// #endif\n\n\t\t\t// #ifndef MP-ALIPAY\n\t\t\tuni.canvasToTempFilePath(\n\t\t\t\t{\n\t\t\t\t\tx: x,\n\t\t\t\t\ty: y,\n\t\t\t\t\twidth: width,\n\t\t\t\t\theight: height,\n\t\t\t\t\texpWidth: width * this.pixelRatio,\n\t\t\t\t\texpHeight: height * this.pixelRatio,\n\t\t\t\t\tcanvasId: 'avatar-canvas',\n\t\t\t\t\tfileType: this.fType,\n\t\t\t\t\tquality: this.qlty,\n\t\t\t\t\tsuccess: r => {\n\t\t\t\t\t\tthis.prvImgTmp = r = r.tempFilePath;\n\n\t\t\t\t\t\tlet ccp = this.ccp,\n\t\t\t\t\t\t\tprvX = this.wW,\n\t\t\t\t\t\t\tprvY = parseInt(this.csH);\n\n\t\t\t\t\t\t// #ifndef H5||MP-WEIXIN||APP-PLUS\n\t\t\t\t\t\tprvY += tH;\n\t\t\t\t\t\t// #endif\n\t\t\t\t\t\t// #ifdef APP-PLUS\n\t\t\t\t\t\tif (this.platform === 'android') {\n\t\t\t\t\t\t\tprvY += tH;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// #endif\n\n\t\t\t\t\t\tlet prvWidth = parseInt(this.sS.width),\n\t\t\t\t\t\t\tprvHeight = parseInt(this.sS.height),\n\t\t\t\t\t\t\tuseWidth = prvX - 40,\n\t\t\t\t\t\t\tuseHeight = prvY - 80,\n\t\t\t\t\t\t\tradio = useWidth / prvWidth,\n\t\t\t\t\t\t\trHeight = prvHeight * radio;\n\t\t\t\t\t\tif (rHeight < useHeight) {\n\t\t\t\t\t\t\tprvWidth = useWidth;\n\t\t\t\t\t\t\tprvHeight = rHeight;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tradio = useHeight / prvHeight;\n\t\t\t\t\t\t\tprvWidth *= radio;\n\t\t\t\t\t\t\tprvHeight = useHeight;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tccp.fillRect(0, 0, prvX, prvY);\n\t\t\t\t\t\tthis.prvX = prvX = ((prvX - prvWidth) / 2) | 0;\n\t\t\t\t\t\tthis.prvY = prvY = ((prvY - prvHeight) / 2) | 0;\n\t\t\t\t\t\tthis.prvWidth = prvWidth = prvWidth | 0;\n\t\t\t\t\t\tthis.prvHeight = prvHeight = prvHeight | 0;\n\t\t\t\t\t\tccp.drawImage(r, prvX, prvY, prvWidth, prvHeight);\n\t\t\t\t\t\tccp.draw(false);\n\n\t\t\t\t\t\t// #ifdef H5\n\t\t\t\t\t\tthis.btop(r).then(r => {\n\t\t\t\t\t\t\tthis.sO = false;\n\t\t\t\t\t\t\tthis.pT = this.drawTop + 'px';\n\t\t\t\t\t\t});\n\t\t\t\t\t\t// #endif\n\n\t\t\t\t\t\tthis.sO = false;\n\t\t\t\t\t\t// if (this.platform === 'android') this.sO = false;\n\t\t\t\t\t\tthis.pT = this.drawTop + 'px';\n\t\t\t\t\t},\n\t\t\t\t\tfail: () => {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: 'error2',\n\t\t\t\t\t\t\tduration: 2000\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tcomplete: () => {\n\t\t\t\t\t\tuni.hideLoading();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tthis\n\t\t\t);\n\t\t\t// #endif\n\t\t},\n\t\tfChooseImg(index = undefined, params = undefined, data = undefined) {\n\t\t\tif (params) {\n\t\t\t\tlet sW = params.selWidth,\n\t\t\t\t\tsH = params.selHeight,\n\t\t\t\t\texpWidth = params.expWidth,\n\t\t\t\t\texpHeight = params.expHeight,\n\t\t\t\t\tquality = params.quality,\n\t\t\t\t\tcanRotate = params.canRotate,\n\t\t\t\t\tcanScale = params.canScale,\n\t\t\t\t\tminScale = params.minScale,\n\t\t\t\t\tmaxScale = params.maxScale,\n\t\t\t\t\tstretch = params.stretch,\n\t\t\t\t\tfileType = params.fileType,\n\t\t\t\t\tinner = params.inner,\n\t\t\t\t\tlock = params.lock;\n\n\t\t\t\texpWidth && (this.eW = expWidth.toString().indexOf('upx') >= 0 ? parseInt(expWidth) * this.pxRatio : parseInt(expWidth));\n\t\t\t\texpHeight && (this.eH = expHeight.toString().indexOf('upx') >= 0 ? parseInt(expHeight) * this.pxRatio : parseInt(expHeight));\n\t\t\t\tthis.letRotate = canRotate === false || inner === true || inner === 'true' || canRotate === 'false' ? 0 : 1;\n\t\t\t\tthis.letScale = canScale === false || canScale === 'false' ? 0 : 1;\n\t\t\t\tthis.qlty = parseFloat(quality) || 1;\n\t\t\t\tthis.mnScale = parseFloat(minScale) || 0.3;\n\t\t\t\tthis.mxScale = parseFloat(maxScale) || 4;\n\t\t\t\tthis.stc = stretch;\n\t\t\t\tthis.isin = inner === true || inner === 'true' ? 1 : 0;\n\t\t\t\tthis.fType = fileType === 'jpg' ? 'jpg' : 'png';\n\t\t\t\tthis.lck = lock;\n\t\t\t\tif (this.isin || !this.letRotate) {\n\t\t\t\t\tthis.bW = '24%';\n\t\t\t\t\tthis.bD = 'none';\n\t\t\t\t} else {\n\t\t\t\t\tthis.bW = '19%';\n\t\t\t\t\tthis.bD = 'flex';\n\t\t\t\t}\n\n\t\t\t\tif (sW && sH) {\n\t\t\t\t\tsW = sW.toString().indexOf('upx') >= 0 ? parseInt(sW) * this.pxRatio : parseInt(sW);\n\t\t\t\t\tsH = sH.toString().indexOf('upx') >= 0 ? parseInt(sH) * this.pxRatio : parseInt(sH);\n\t\t\t\t\tthis.sS.width = sW + 'px';\n\t\t\t\t\tthis.sS.height = sH + 'px';\n\t\t\t\t\tthis.sS.top = ((this.wH - sH - tH) | 0) / 2 + 'px';\n\t\t\t\t\tthis.sS.left = ((this.wW - sW) | 0) / 2 + 'px';\n\t\t\t\t\tthis.hasSel = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.rtn = data;\n\t\t\tthis.indx = index;\n\t\t\tthis.fSelect();\n\t\t},\n\t\tfRotate() {\n\t\t\tthis.rotateDeg += 90 - (this.rotateDeg % 90);\n\t\t\tthis.fDrawImage();\n\t\t},\n\t\tfStart(e) {\n\t\t\tlet touches = e.touches,\n\t\t\t\ttouch0 = touches[0],\n\t\t\t\ttouch1 = touches[1];\n\n\t\t\tthis.touch0 = touch0;\n\t\t\tthis.touch1 = touch1;\n\n\t\t\tif (touch1) {\n\t\t\t\tlet x = touch1.x - touch0.x,\n\t\t\t\t\ty = touch1.y - touch0.y;\n\t\t\t\tthis.fgDistance = Math.sqrt(x * x + y * y);\n\t\t\t}\n\t\t},\n\t\tfMove(e) {\n\t\t\tlet touches = e.touches,\n\t\t\t\ttouch0 = touches[0],\n\t\t\t\ttouch1 = touches[1];\n\n\t\t\tif (touch1) {\n\t\t\t\tlet x = touch1.x - touch0.x,\n\t\t\t\t\ty = touch1.y - touch0.y,\n\t\t\t\t\tfgDistance = Math.sqrt(x * x + y * y),\n\t\t\t\t\tscaleSize = 0.005 * (fgDistance - this.fgDistance),\n\t\t\t\t\tbeScaleSize = this.scaleSize + scaleSize;\n\n\t\t\t\tdo {\n\t\t\t\t\tif (!this.letScale) break;\n\t\t\t\t\tif (beScaleSize < this.mnScale) break;\n\t\t\t\t\tif (beScaleSize > this.mxScale) break;\n\n\t\t\t\t\tlet growX = (this.useWidth * scaleSize) / 2,\n\t\t\t\t\t\tgrowY = (this.useHeight * scaleSize) / 2;\n\t\t\t\t\tif (this.isin) {\n\t\t\t\t\t\tlet imgWidth = this.useWidth * beScaleSize,\n\t\t\t\t\t\t\timgHeight = this.useHeight * beScaleSize,\n\t\t\t\t\t\t\tl = this.posWidth - growX,\n\t\t\t\t\t\t\tt = this.posHeight - growY,\n\t\t\t\t\t\t\tr = l + imgWidth,\n\t\t\t\t\t\t\tb = t + imgHeight,\n\t\t\t\t\t\t\tleft = parseInt(this.sS.left),\n\t\t\t\t\t\t\ttop = parseInt(this.sS.top),\n\t\t\t\t\t\t\twidth = parseInt(this.sS.width),\n\t\t\t\t\t\t\theight = parseInt(this.sS.height),\n\t\t\t\t\t\t\tright = left + width,\n\t\t\t\t\t\t\tbottom = top + height,\n\t\t\t\t\t\t\tcx,\n\t\t\t\t\t\t\tcy;\n\n\t\t\t\t\t\tif (imgWidth <= width || imgHeight <= height) break;\n\t\t\t\t\t\t(this.cx = cx = this.focusX * beScaleSize - this.focusX), (this.cy = cy = this.focusY * beScaleSize - this.focusY);\n\t\t\t\t\t\tthis.posWidth -= growX;\n\t\t\t\t\t\tthis.posHeight -= growY;\n\t\t\t\t\t\tif (this.posWidth - cx > left) {\n\t\t\t\t\t\t\tthis.posWidth = left + cx;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (this.posWidth + imgWidth - cx < right) {\n\t\t\t\t\t\t\tthis.posWidth = right - imgWidth + cx;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (this.posHeight - cy > top) {\n\t\t\t\t\t\t\tthis.posHeight = top + cy;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (this.posHeight + imgHeight - cy < bottom) {\n\t\t\t\t\t\t\tthis.posHeight = bottom - imgHeight + cy;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.posWidth -= growX;\n\t\t\t\t\t\tthis.posHeight -= growY;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.scaleSize = beScaleSize;\n\t\t\t\t} while (0);\n\t\t\t\tthis.fgDistance = fgDistance;\n\t\t\t\tif (touch1.x !== touch0.x && this.letRotate) {\n\t\t\t\t\tx = (this.touch1.y - this.touch0.y) / (this.touch1.x - this.touch0.x);\n\t\t\t\t\ty = (touch1.y - touch0.y) / (touch1.x - touch0.x);\n\t\t\t\t\tthis.rotateDeg += (Math.atan((y - x) / (1 + x * y)) * 180) / Math.PI;\n\t\t\t\t\tthis.touch0 = touch0;\n\t\t\t\t\tthis.touch1 = touch1;\n\t\t\t\t}\n\n\t\t\t\tthis.fDrawImage();\n\t\t\t} else if (this.touch0) {\n\t\t\t\tlet x = touch0.x - this.touch0.x,\n\t\t\t\t\ty = touch0.y - this.touch0.y,\n\t\t\t\t\tbeX = this.posWidth + x,\n\t\t\t\t\tbeY = this.posHeight + y;\n\t\t\t\tif (this.isin) {\n\t\t\t\t\tlet imgWidth = this.useWidth * this.scaleSize,\n\t\t\t\t\t\timgHeight = this.useHeight * this.scaleSize,\n\t\t\t\t\t\tl = beX,\n\t\t\t\t\t\tt = beY,\n\t\t\t\t\t\tr = l + imgWidth,\n\t\t\t\t\t\tb = t + imgHeight,\n\t\t\t\t\t\tleft = parseInt(this.sS.left),\n\t\t\t\t\t\ttop = parseInt(this.sS.top),\n\t\t\t\t\t\tright = left + parseInt(this.sS.width),\n\t\t\t\t\t\tbottom = top + parseInt(this.sS.height),\n\t\t\t\t\t\tcx,\n\t\t\t\t\t\tcy;\n\n\t\t\t\t\tthis.cx = cx = this.focusX * this.scaleSize - this.focusX;\n\t\t\t\t\tthis.cy = cy = this.focusY * this.scaleSize - this.focusY;\n\n\t\t\t\t\tif (!this.lckWidth && Math.abs(x) < 100) {\n\t\t\t\t\t\tif (left < l - cx) {\n\t\t\t\t\t\t\tthis.posWidth = left + cx;\n\t\t\t\t\t\t} else if (right > r - cx) {\n\t\t\t\t\t\t\tthis.posWidth = right - imgWidth + cx;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.posWidth = beX;\n\t\t\t\t\t\t\tthis.focusX -= x;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (!this.lckHeight && Math.abs(y) < 100) {\n\t\t\t\t\t\tif (top < t - cy) {\n\t\t\t\t\t\t\tthis.focusY -= top + cy - this.posHeight;\n\t\t\t\t\t\t\tthis.posHeight = top + cy;\n\t\t\t\t\t\t} else if (bottom > b - cy) {\n\t\t\t\t\t\t\tthis.focusY -= bottom + cy - (this.posHeight + imgHeight);\n\t\t\t\t\t\t\tthis.posHeight = bottom - imgHeight + cy;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.posHeight = beY;\n\t\t\t\t\t\t\tthis.focusY -= y;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (Math.abs(x) < 100 && !this.lckWidth) this.posWidth = beX;\n\t\t\t\t\tif (Math.abs(y) < 100 && !this.lckHeight) this.posHeight = beY;\n\t\t\t\t\tthis.focusX -= x;\n\t\t\t\t\tthis.focusY -= y;\n\t\t\t\t}\n\n\t\t\t\tthis.touch0 = touch0;\n\t\t\t\tthis.fDrawImage();\n\t\t\t}\n\t\t},\n\t\tfEnd(e) {\n\t\t\tlet touches = e.touches,\n\t\t\t\ttouch0 = touches && touches[0],\n\t\t\t\ttouch1 = touches && touches[1];\n\t\t\tif (touch0) {\n\t\t\t\tthis.touch0 = touch0;\n\t\t\t} else {\n\t\t\t\tthis.touch0 = null;\n\t\t\t\tthis.touch1 = null;\n\t\t\t}\n\t\t},\n\t\tfHideImg() {\n\t\t\tthis.prvImg = '';\n\t\t\tthis.pT = '-10000px';\n\t\t\tthis.sO = true;\n\t\t\tthis.prvImgData = null;\n\t\t\tthis.target = null;\n\t\t},\n\t\tfClose() {\n\t\t\tthis.sD = 'none';\n\t\t\tthis.sT = '-10000px';\n\t\t\tthis.hasSel = false;\n\t\t\tthis.fHideImg();\n\t\t\tthis.noBar || uni.showTabBar();\n\t\t\tthis.$emit('end');\n\t\t},\n\t\tfGetImgData() {\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tlet prvX = this.prvX,\n\t\t\t\t\tprvY = this.prvY,\n\t\t\t\t\tprvWidth = this.prvWidth,\n\t\t\t\t\tprvHeight = this.prvHeight;\n\t\t\t\t// #ifdef MP-ALIPAY\n\t\t\t\tthis.ccp.getImageData(\n\t\t\t\t\t{\n\t\t\t\t\t\tx: prvX,\n\t\t\t\t\t\ty: prvY,\n\t\t\t\t\t\twidth: prvWidth,\n\t\t\t\t\t\theight: prvHeight,\n\t\t\t\t\t\tsuccess(res) {\n\t\t\t\t\t\t\tresolve(res.data);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tfail(err) {\n\t\t\t\t\t\t\treject(err);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tthis\n\t\t\t\t);\n\t\t\t\t// #endif\n\t\t\t\t// #ifndef MP-ALIPAY\n\t\t\t\tuni.canvasGetImageData(\n\t\t\t\t\t{\n\t\t\t\t\t\tcanvasId: 'prv-canvas',\n\t\t\t\t\t\tx: prvX,\n\t\t\t\t\t\ty: prvY,\n\t\t\t\t\t\twidth: prvWidth,\n\t\t\t\t\t\theight: prvHeight,\n\t\t\t\t\t\tsuccess(res) {\n\t\t\t\t\t\t\tresolve(res.data);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tfail(err) {\n\t\t\t\t\t\t\treject(err);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tthis\n\t\t\t\t);\n\t\t\t\t// #endif\n\t\t\t});\n\t\t},\n\t\tasync fColorChange(e) {\n\t\t\tlet tm_now = Date.now();\n\t\t\tif (tm_now - this.prvTm < 100) return;\n\t\t\tthis.prvTm = tm_now;\n\n\t\t\t// #ifdef MP-ALIPAY\n\t\t\tuni.showLoading();\n\t\t\t// #endif\n\t\t\t// #ifndef MP-ALIPAY\n\t\t\tuni.showLoading({\n\t\t\t\ttitle: '加载中...',\n\t\t\t\tmask: true\n\t\t\t});\n\t\t\t// #endif\n\n\t\t\tif (!this.prvImgData) {\n\t\t\t\tif (\n\t\t\t\t\t!(this.prvImgData = await this.fGetImgData().catch(() => {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: 'error_read',\n\t\t\t\t\t\t\tduration: 2000\n\t\t\t\t\t\t});\n\t\t\t\t\t}))\n\t\t\t\t)\n\t\t\t\t\treturn;\n\n\t\t\t\tthis.target = new Uint8ClampedArray(this.prvImgData.length);\n\t\t\t}\n\n\t\t\tlet data = this.prvImgData,\n\t\t\t\ttarget = this.target,\n\t\t\t\ti = e.detail.value,\n\t\t\t\tr,\n\t\t\t\tg,\n\t\t\t\tb,\n\t\t\t\ta,\n\t\t\t\th,\n\t\t\t\ts,\n\t\t\t\tl,\n\t\t\t\td,\n\t\t\t\tp,\n\t\t\t\tq,\n\t\t\t\tt,\n\t\t\t\tmin,\n\t\t\t\tmax,\n\t\t\t\thK,\n\t\t\t\ttR,\n\t\t\t\ttG,\n\t\t\t\ttB;\n\n\t\t\tif (i === 0) {\n\t\t\t\ttarget = data;\n\t\t\t} else {\n\t\t\t\ti = (i + 100) / 200;\n\t\t\t\tif (i < 0.005) i = 0;\n\t\t\t\tif (i > 0.995) i = 1;\n\t\t\t\tfor (let n = data.length - 1; n >= 0; n -= 4) {\n\t\t\t\t\tr = data[n - 3] / 255;\n\t\t\t\t\tg = data[n - 2] / 255;\n\t\t\t\t\tb = data[n - 1] / 255;\n\t\t\t\t\tmax = Math.max(r, g, b);\n\t\t\t\t\tmin = Math.min(r, g, b);\n\t\t\t\t\td = max - min;\n\t\t\t\t\tif (max === min) {\n\t\t\t\t\t\th = 0;\n\t\t\t\t\t} else if (max === r && g >= b) {\n\t\t\t\t\t\th = 60 * ((g - b) / d);\n\t\t\t\t\t} else if (max === r && g < b) {\n\t\t\t\t\t\th = 60 * ((g - b) / d) + 360;\n\t\t\t\t\t} else if (max === g) {\n\t\t\t\t\t\th = 60 * ((b - r) / d) + 120;\n\t\t\t\t\t} else if (max === b) {\n\t\t\t\t\t\th = 60 * ((r - g) / d) + 240;\n\t\t\t\t\t}\n\t\t\t\t\tl = (max + min) / 2;\n\t\t\t\t\tif (l === 0 || max === min) {\n\t\t\t\t\t\ts = 0;\n\t\t\t\t\t} else if (0 < l && l <= 0.5) {\n\t\t\t\t\t\ts = d / (2 * l);\n\t\t\t\t\t} else if (l > 0.5) {\n\t\t\t\t\t\ts = d / (2 - 2 * l);\n\t\t\t\t\t}\n\t\t\t\t\tdata[n] && (a = data[n]);\n\n\t\t\t\t\tif (i < 0.5) {\n\t\t\t\t\t\ts = (s * i) / 0.5;\n\t\t\t\t\t} else if (i > 0.5) {\n\t\t\t\t\t\ts = 2 * s + 2 * i - (s * i) / 0.5 - 1;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (s === 0) {\n\t\t\t\t\t\tr = g = b = Math.round(l * 255);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (l < 0.5) {\n\t\t\t\t\t\t\tq = l * (1 + s);\n\t\t\t\t\t\t} else if (l >= 0.5) {\n\t\t\t\t\t\t\tq = l + s - l * s;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tp = 2 * l - q;\n\t\t\t\t\t\thK = h / 360;\n\t\t\t\t\t\ttR = hK + 1 / 3;\n\t\t\t\t\t\ttG = hK;\n\t\t\t\t\t\ttB = hK - 1 / 3;\n\t\t\t\t\t\tlet correctRGB = t => {\n\t\t\t\t\t\t\tif (t < 0) {\n\t\t\t\t\t\t\t\treturn t + 1.0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (t > 1) {\n\t\t\t\t\t\t\t\treturn t - 1.0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn t;\n\t\t\t\t\t\t};\n\t\t\t\t\t\tlet createRGB = t => {\n\t\t\t\t\t\t\tif (t < 1 / 6) {\n\t\t\t\t\t\t\t\treturn p + (q - p) * 6 * t;\n\t\t\t\t\t\t\t} else if (t >= 1 / 6 && t < 1 / 2) {\n\t\t\t\t\t\t\t\treturn q;\n\t\t\t\t\t\t\t} else if (t >= 1 / 2 && t < 2 / 3) {\n\t\t\t\t\t\t\t\treturn p + (q - p) * 6 * (2 / 3 - t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn p;\n\t\t\t\t\t\t};\n\t\t\t\t\t\tr = tR = Math.round(createRGB(correctRGB(tR)) * 255);\n\t\t\t\t\t\tg = tG = Math.round(createRGB(correctRGB(tG)) * 255);\n\t\t\t\t\t\tb = tB = Math.round(createRGB(correctRGB(tB)) * 255);\n\t\t\t\t\t}\n\t\t\t\t\ta && (target[n] = a);\n\t\t\t\t\ttarget[n - 3] = r;\n\t\t\t\t\ttarget[n - 2] = g;\n\t\t\t\t\ttarget[n - 1] = b;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet prvX = this.prvX,\n\t\t\t\tprvY = this.prvY,\n\t\t\t\tprvWidth = this.prvWidth,\n\t\t\t\tprvHeight = this.prvHeight;\n\n\t\t\t// #ifdef MP-ALIPAY\n\t\t\tthis.ccp.putImageData(\n\t\t\t\t{\n\t\t\t\t\tx: prvX,\n\t\t\t\t\ty: prvY,\n\t\t\t\t\twidth: prvWidth,\n\t\t\t\t\theight: prvHeight,\n\t\t\t\t\tdata: target,\n\t\t\t\t\tfail() {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: 'error_put',\n\t\t\t\t\t\t\tduration: 2000\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tcomplete() {\n\t\t\t\t\t\tuni.hideLoading();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tthis\n\t\t\t);\n\t\t\t// #endif\n\n\t\t\t// #ifndef MP-ALIPAY\n\t\t\tuni.canvasPutImageData(\n\t\t\t\t{\n\t\t\t\t\tcanvasId: 'prv-canvas',\n\t\t\t\t\tx: prvX,\n\t\t\t\t\ty: prvY,\n\t\t\t\t\twidth: prvWidth,\n\t\t\t\t\theight: prvHeight,\n\t\t\t\t\tdata: target,\n\t\t\t\t\tfail() {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: 'error_put',\n\t\t\t\t\t\t\tduration: 2000\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tcomplete() {\n\t\t\t\t\t\tuni.hideLoading();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tthis\n\t\t\t);\n\t\t\t// #endif\n\t\t},\n\t\tbtop(base64) {\n\t\t\tthis.base64 = base64;\n\t\t\treturn new Promise(function(resolve, reject) {\n\t\t\t\tvar arr = base64.split(','),\n\t\t\t\t\tmime = arr[0].match(/:(.*?);/)[1],\n\t\t\t\t\tbstr = atob(arr[1]),\n\t\t\t\t\tn = bstr.length,\n\t\t\t\t\tu8arr = new Uint8Array(n);\n\t\t\t\twhile (n--) {\n\t\t\t\t\tu8arr[n] = bstr.charCodeAt(n);\n\t\t\t\t}\n\t\t\t\treturn resolve(\n\t\t\t\t\t(window.URL || window.webkitURL).createObjectURL(\n\t\t\t\t\t\tnew Blob([u8arr], {\n\t\t\t\t\t\t\ttype: mime\n\t\t\t\t\t\t})\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\t}\n};\n</script>\n\n<style>\n.my-canvas {\n\t/* height: 95% !important; */\n\tdisplay: flex;\n\tposition: fixed !important;\n\tbackground: #000000;\n\tleft: 0;\n\tz-index: 100000;\n\twidth: 100%;\n}\n\n.my-avatar {\n\twidth: 150upx;\n\theight: 150upx;\n\tborder-radius: 100%;\n}\n\n.oper-canvas {\n\tdisplay: flex;\n\tposition: fixed !important;\n\tleft: 0;\n\tz-index: 100001;\n\twidth: 100%;\n}\n\n.prv-canvas {\n\tdisplay: flex;\n\tposition: fixed !important;\n\tbackground: #000000;\n\tleft: 0;\n\tz-index: 200000;\n\twidth: 100%;\n}\n\n.oper-wrapper {\n\t/* top: 92% !important; */\n\theight: 100rpx;\n\t/* height: 50px; */\n\tposition: fixed !important;\n\tbox-sizing: border-box;\n\tborder: 1px solid #f1f1f1;\n\tbackground: #ffffff;\n\twidth: 100%;\n\tleft: 0;\n\tbottom: 0;\n\tz-index: 100009;\n\tflex-direction: row;\n}\n\n.oper {\n\tdisplay: flex;\n\tflex-direction: column;\n\tjustify-content: center;\n\tpadding: 10upx 20upx;\n\twidth: 100%;\n\theight: 100%;\n\tbox-sizing: border-box;\n\talign-self: center;\n}\n\n.btn-wrapper {\n\tdisplay: flex;\n\tflex-direction: row;\n\t/* #ifndef H5 */\n\tflex-grow: 1;\n\t/* #endif */\n\t/* #ifdef H5 */\n\theight: 50px;\n\t/* #endif */\n\tjustify-content: space-between;\n}\n\n.btn-wrapper view {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tfont-size: 16px;\n\tcolor: #333;\n\tborder: 1px solid #f1f1f1;\n\tborder-radius: 6%;\n}\n\n.hover {\n\tbackground: #f1f1f1;\n\tborder-radius: 6%;\n}\n\n.clr-wrapper {\n\tdisplay: flex;\n\tflex-direction: row;\n\tflex-grow: 1;\n}\n\n.clr-wrapper view {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tfont-size: 16px;\n\tcolor: #333;\n\tborder: 1px solid #f1f1f1;\n\tborder-radius: 6%;\n}\n\n.my-slider {\n\tflex-grow: 1;\n}\n</style>\n","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cropping.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cropping.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1709363660820\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}